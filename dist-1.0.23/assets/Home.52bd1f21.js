import{_ as R,r as O,o as n,c as _,a as y,u as c,I as E,b as s,t as U,d as C,S as A,e as d,f as X,w as T,v as B,n as I,i as Y,g as Z,h as ee,j as ae,k as le,l as se,m as te,p as ne,q as oe,F as N,s as H,x as ce,y as re,z as ie,A as de}from"./index.dd783b7f.js";import{L as ue,S as z}from"./Songs.01b6ff99.js";import{g as L}from"./_api.7a0ec99c.js";import{_ as _e,a as ve}from"./Playlists.2c9f44d7.js";import"./Albums.669f5fff.js";const me={class:"daily-recommend-card"},ge={class:"container"},ye={class:"title-box"},pe={class:"title"},he={__name:"DailyTracksCard",props:{url:String,loading:Boolean},emits:["on-play"],setup(i,{emit:F}){const o=F,x=()=>{o("on-play")};return(D,p)=>{const b=O("svg-icon");return n(),_("div",me,[y(c(E),{src:i.url,class:"img"},null,8,["src"]),s("div",ge,[s("div",ye,[s("div",pe,U(D.$t("home.dailyRecommand")),1)])]),s("button",{onClick:x,class:"play-buttons"},[i.loading?(n(),C(c(A),{key:0,color:"#fff"})):(n(),C(b,{key:1,class:"play","icon-class":"next"}))])])}}};var fe=R(he,[["__scopeId","data-v-25834c8f"]]);const ke={class:"cover"},xe={class:"right-part"},be={class:"info"},$e={class:"controls"},we={class:"buttons"},Se={__name:"FMDailyTracksCard",props:{url:String,name:String,desc:{type:Array,default:()=>[]},nextloading:Boolean,playloading:Boolean},emits:["on-play","on-next"],setup(i,{emit:F}){const o=d({background:"#fff"}),x=d(!1),D=i,{url:p}=X(D),b=F,$=()=>{b("on-next")},v=()=>{b("on-play")},w=()=>{!p.value||Y(p.value,{ignore:["rgb(255,255,255)","rgb(0,0,0)"],scale:.6}).then(S=>{const[h,m]=S;o.value={background:`linear-gradient(to top left,${h.color}, ${m.color})`,text_color:h.color.replace(new RegExp(/[rgb()]/g),",").split(",").reduce((f,M)=>M.length?f+","+(255-Number(M)):f).replace(",","rgb(")+")"},Z(()=>{x.value=!0})})};return(S,h)=>{const m=O("svg-icon");return T((n(),_("div",{class:"fm",style:I({background:o.value.background}),"data-theme":"dark"},[s("div",ke,[y(c(E),{class:"cover",src:c(p),onLoad:w},null,8,["src"])]),s("div",xe,[s("div",be,[s("div",{class:"title",style:I({color:o.value.text_color})},U(i.name),5),s("div",{class:"artist",style:I({color:o.value.text_color})},[y(c(ue),{artisits:i.desc},null,8,["artisits"])],4)]),s("div",$e,[s("div",we,[s("button",{style:I({"border-color":o.value.text_color}),class:"play-button button-icon",onClick:v},[i.playloading?(n(),C(c(A),{key:0,color:o.value.text_color},null,8,["color"])):(n(),C(m,{key:1,style:I({color:o.value.text_color}),class:"svg-icon","icon-class":"play"},null,8,["style"]))],4),s("button",{style:I({"border-color":o.value.text_color}),onClick:$,class:"play-button button-icon"},[i.nextloading?(n(),C(c(A),{key:0,color:o.value.text_color},null,8,["color"])):(n(),C(m,{key:1,style:I({color:o.value.text_color}),class:"svg-icon","icon-class":"next"},null,8,["style"]))],4)])])])],4)),[[B,x.value]])}}};var Ie=R(Se,[["__scopeId","data-v-855e4d00"]]);const Ce=i=>(ie("data-v-16356f09"),i=i(),de(),i),De={class:"home-container"},Te={class:"recommand box fr-2"},Be={class:"song fr-2"},Ue={class:"box fr-3"},Fe=Ce(()=>s("br",null,null,-1)),Le={class:"song fr-6"},Me={__name:"Home",setup(i){const F=ee(),o=d([]),x=d({}),D=d([]),p=d([]),b=d([]),$=d([]),v=d({}),w=d(!0),S=d(!1),h=d(!1),m=d(!1),f=(l,r)=>Math.floor(Math.random()*(r-l+1))+l;ae(()=>{M()});const M=()=>{w.value=!0,Promise.all([le(),se(),te(),ne()]).then(([l,r,e,t])=>{w.value=!1;const a=["\u65B0\u6B4C\u699C","\u98D9\u5347\u699C","\u70ED\u6B4C\u699C","\u7F51\u7EDC\u70ED\u6B4C\u699C","\u7F8E\u56FDBillboard\u699C","\u539F\u521B\u699C"];o.value=a.map(J=>l.list.find(K=>K.name===J)),D.value=r.result;const{playlists:u}=e;p.value=u;const g=f(1,u.length-1);$.value=u[g],q();const k=f(6,t.artists.length-7);b.value=t.artists.slice(k,k+6),V()}).catch(l=>{throw w.value=!1,l})},V=()=>{o.value.map((l,r)=>{(t=>{L({id:t.id}).then(a=>{var u,g;a.code?x.value[t.name]=(g=(u=a==null?void 0:a.playlist)==null?void 0:u.tracks)==null?void 0:g.slice(0,10):L(t)}).catch(a=>{L(t)})})(l)})},j=async()=>{S.value=!0;const{playlist:l}=await L({id:$.value.id});if(!l.trackIds)return;const r=f(1,l.trackIds.length-1),{id:e}=l.trackIds[r];P(e)},Q=()=>{h.value=!0,P(v.value.id)},W=async()=>{m.value=!0,await q(),P(v.value.id)},q=async()=>{var k;const l=f(1,p.value.length-1),r=p.value[l],e=await G(r.id),t=(k=e==null?void 0:e.al)==null?void 0:k.picUrl,a=e.name,u=e.id,g=e==null?void 0:e.ar;v.value={url:t,name:a,desc:g,id:u}},G=async l=>{let r={};const{playlist:e}=await L({id:l}),t=f(1,e.trackIds.length-1),{id:a}=e.trackIds[t],{songs:u}=await oe({ids:a});return[r]=u,r},P=l=>{F.dispatch("fetch_song_data",l).then(()=>{S.value=!1,h.value=!1,m.value=!1}).catch(()=>{S.value=!1,h.value=!1,m.value=!1})};return(l,r)=>(n(),_("div",null,[T(y(c(ce),{style:{margin:"3%"},width:"74%",height:"80vh",animated:"",bg:"transparent"},null,512),[[B,w.value]]),T(s("div",De,[T(s("h1",null,U(l.$t("home.browser")),513),[[B,$.value.coverImgUrl]]),s("div",Te,[T(y(c(fe),{url:$.value.coverImgUrl,loading:S.value,onOnPlay:r[0]||(r[0]=e=>j())},null,8,["url","loading"]),[[B,$.value.coverImgUrl]]),T(y(c(Ie),{url:v.value.url,name:v.value.name,desc:v.value.desc,nextloading:m.value,playloading:h.value,onOnPlay:Q,onOnNext:W},null,8,["url","name","desc","nextloading","playloading"]),[[B,v.value.url]])]),s("h1",null,U(l.$t("home.new")),1),s("div",Be,[(n(!0),_(N,null,H(D.value,(e,t)=>{var a;return n(),_("div",{key:t},[y(c(z),{image:e.picUrl,name:e.name,id:e.id,desc:(a=e==null?void 0:e.song)==null?void 0:a.artists},null,8,["image","name","id","desc"])])}),128))]),s("h1",null,U(l.$t("home.top")),1),s("div",Ue,[(n(!0),_(N,null,H(o.value,(e,t)=>(n(),_("div",{class:"card",key:t},[y(c(_e),{name:e.name,oldesc:e.updateFrequency,count:c(re)(e.playCount),id:e.id},null,8,["name","oldesc","count","id"]),Fe,(n(!0),_(N,null,H(x.value[e.name],(a,u)=>{var g,k;return n(),C(c(z),{key:a==null?void 0:a.id,image:(g=a==null?void 0:a.al)==null?void 0:g.picUrl,name:(k=a==null?void 0:a.al)==null?void 0:k.name,id:a==null?void 0:a.id,desc:a==null?void 0:a.ar,index:u+1,notShowHover:""},null,8,["image","name","id","desc","index"])}),128))]))),128))]),s("h1",null,U(l.$t("home.singer")),1),s("div",Le,[(n(!0),_(N,null,H(b.value,(e,t)=>(n(),_("div",{key:t},[y(c(ve),{image:e.picUrl,name:e.name,id:e.id},null,8,["image","name","id"])]))),128))])],512),[[B,!w.value]])]))}};var qe=R(Me,[["__scopeId","data-v-16356f09"]]);export{qe as default};
